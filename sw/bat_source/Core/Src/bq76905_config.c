/*
 * driver_bq76905.c
 *
 *  Created on: Jun 14, 2025
 *      Author: ahorat
 */

#include "bq76905.h"
#include "bq76905_data_memory_map.h"
#include "bq76905_config.h"
#include "bq76905_config_flags.h"

typedef struct{
    uint16_t address;
    uint16_t value;
    uint8_t len;    
} config_list_entry;



// Some #if are removed, because they can no be evaluated. Reason is floating point operations in the calculation of the value.

config_list_entry config_list[] = {                                                                                              

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_1 != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_1
    {BQ76905_REG_CAL_VOLT_GAIN_1, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_1, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_STACK != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_STACK
    {BQ76905_REG_CAL_VOLT_GAIN_STACK, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_STACK, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_2 != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_DELTA_2
    {BQ76905_REG_CAL_VOLT_GAIN_DELTA_2, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_2, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_3 != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_DELTA_3
    {BQ76905_REG_CAL_VOLT_GAIN_DELTA_3, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_3, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_4 != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_DELTA_4
    {BQ76905_REG_CAL_VOLT_GAIN_DELTA_4, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_4, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_5 != BQ76905_DEFAULT_VALUE_CAL_VOLT_GAIN_DELTA_5
    {BQ76905_REG_CAL_VOLT_GAIN_DELTA_5, BQ76905_CONFIG_VALUE_CAL_VOLT_GAIN_DELTA_5, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_CUR_GAIN != BQ76905_DEFAULT_VALUE_CAL_CUR_GAIN
    {BQ76905_REG_CAL_CUR_GAIN, BQ76905_CONFIG_VALUE_CAL_CUR_GAIN, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_CUR_OFFSET != BQ76905_DEFAULT_VALUE_CAL_CUR_OFFSET
    {BQ76905_REG_CAL_CUR_OFFSET, BQ76905_CONFIG_VALUE_CAL_CUR_OFFSET, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_CC1_GAIN != BQ76905_DEFAULT_VALUE_CAL_CC1_GAIN
    {BQ76905_REG_CAL_CC1_GAIN, BQ76905_CONFIG_VALUE_CAL_CC1_GAIN, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_CC1_OFFSET != BQ76905_DEFAULT_VALUE_CAL_CC1_OFFSET
    {BQ76905_REG_CAL_CC1_OFFSET, BQ76905_CONFIG_VALUE_CAL_CC1_OFFSET, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_TS_OFFSET != BQ76905_DEFAULT_VALUE_CAL_TS_OFFSET
    {BQ76905_REG_CAL_TS_OFFSET, BQ76905_CONFIG_VALUE_CAL_TS_OFFSET, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_TEMP_INT_GAIN != BQ76905_DEFAULT_VALUE_CAL_TEMP_INT_GAIN
    {BQ76905_REG_CAL_TEMP_INT_GAIN, BQ76905_CONFIG_VALUE_CAL_TEMP_INT_GAIN, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CAL_TEMP_INT_OFFSET != BQ76905_DEFAULT_VALUE_CAL_TEMP_INT_OFFSET
    {BQ76905_REG_CAL_TEMP_INT_OFFSET, BQ76905_CONFIG_VALUE_CAL_TEMP_INT_OFFSET, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_PWR != BQ76905_DEFAULT_VALUE_CONFIG_PWR
    {BQ76905_REG_CONFIG_PWR, BQ76905_CONFIG_VALUE_CONFIG_PWR, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_REGOUT != BQ76905_DEFAULT_VALUE_CONFIG_REGOUT
    {BQ76905_REG_CONFIG_REGOUT, BQ76905_CONFIG_VALUE_CONFIG_REGOUT, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_I2C_ADDR != BQ76905_DEFAULT_VALUE_CONFIG_I2C_ADDR
    {BQ76905_REG_CONFIG_I2C_ADDR, BQ76905_CONFIG_VALUE_CONFIG_I2C_ADDR, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_I2C != BQ76905_DEFAULT_VALUE_CONFIG_I2C
    {BQ76905_REG_CONFIG_I2C, BQ76905_CONFIG_VALUE_CONFIG_I2C, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_DA != BQ76905_DEFAULT_VALUE_CONFIG_DA
    {BQ76905_REG_CONFIG_DA, BQ76905_CONFIG_VALUE_CONFIG_DA, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_VCELL_MODE != BQ76905_DEFAULT_VALUE_CONFIG_VCELL_MODE
    {BQ76905_REG_CONFIG_VCELL_MODE, BQ76905_CONFIG_VALUE_CONFIG_VCELL_MODE, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_ALARM_MASK != BQ76905_DEFAULT_VALUE_CONFIG_ALARM_MASK
    {BQ76905_REG_CONFIG_ALARM_MASK, BQ76905_CONFIG_VALUE_CONFIG_ALARM_MASK, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_FET_OPTIONS != BQ76905_DEFAULT_VALUE_CONFIG_FET_OPTIONS
    {BQ76905_REG_CONFIG_FET_OPTIONS, BQ76905_CONFIG_VALUE_CONFIG_FET_OPTIONS, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_CONFIG_CHARGE_DET_TIME != BQ76905_DEFAULT_VALUE_CONFIG_CHARGE_DET_TIME
    {BQ76905_REG_CONFIG_CHARGE_DET_TIME, BQ76905_CONFIG_VALUE_CONFIG_CHARGE_DET_TIME, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_BAL_CONFIG != BQ76905_DEFAULT_VALUE_BAL_CONFIG
    {BQ76905_REG_BAL_CONFIG, BQ76905_CONFIG_VALUE_BAL_CONFIG, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_BAL_MIN_TEMP != BQ76905_DEFAULT_VALUE_BAL_MIN_TEMP
    {BQ76905_REG_BAL_MIN_TEMP, BQ76905_CONFIG_VALUE_BAL_MIN_TEMP, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_BAL_MAX_TEMP != BQ76905_DEFAULT_VALUE_BAL_MAX_TEMP
    {BQ76905_REG_BAL_MAX_TEMP, BQ76905_CONFIG_VALUE_BAL_MAX_TEMP, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_BAL_MAX_INT_TEMP != BQ76905_DEFAULT_VALUE_BAL_MAX_INT_TEMP
    {BQ76905_REG_BAL_MAX_INT_TEMP, BQ76905_CONFIG_VALUE_BAL_MAX_INT_TEMP, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_EN_A != BQ76905_DEFAULT_VALUE_PROT_EN_A
    {BQ76905_REG_PROT_EN_A, BQ76905_CONFIG_VALUE_PROT_EN_A, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_EN_B != BQ76905_DEFAULT_VALUE_PROT_EN_B
    {BQ76905_REG_PROT_EN_B, BQ76905_CONFIG_VALUE_PROT_EN_B, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_DSG_FET_A != BQ76905_DEFAULT_VALUE_PROT_DSG_FET_A
    {BQ76905_REG_PROT_DSG_FET_A, BQ76905_CONFIG_VALUE_PROT_DSG_FET_A, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CHG_FET_A != BQ76905_DEFAULT_VALUE_PROT_CHG_FET_A
    {BQ76905_REG_PROT_CHG_FET_A, BQ76905_CONFIG_VALUE_PROT_CHG_FET_A, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_FET_B != BQ76905_DEFAULT_VALUE_PROT_FET_B
    {BQ76905_REG_PROT_FET_B, BQ76905_CONFIG_VALUE_PROT_FET_B, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_BODY_DIODE != BQ76905_DEFAULT_VALUE_PROT_BODY_DIODE
    {BQ76905_REG_PROT_BODY_DIODE, BQ76905_CONFIG_VALUE_PROT_BODY_DIODE, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CELL_COWNTIME != BQ76905_DEFAULT_VALUE_PROT_CELL_COWNTIME
    {BQ76905_REG_PROT_CELL_COWNTIME, BQ76905_CONFIG_VALUE_PROT_CELL_COWNTIME, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CELL_OW_SLEEP != BQ76905_DEFAULT_VALUE_PROT_CELL_OW_SLEEP
    {BQ76905_REG_PROT_CELL_OW_SLEEP, BQ76905_CONFIG_VALUE_PROT_CELL_OW_SLEEP, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_WD_TIMEOUT != BQ76905_DEFAULT_VALUE_PROT_WD_TIMEOUT
    {BQ76905_REG_PROT_WD_TIMEOUT, BQ76905_CONFIG_VALUE_PROT_WD_TIMEOUT, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_UV_TH != BQ76905_DEFAULT_VALUE_PROT_VCELL_UV_TH
    {BQ76905_REG_PROT_VCELL_UV_TH, BQ76905_CONFIG_VALUE_PROT_VCELL_UV_TH, 2},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_UV_DELAY != BQ76905_DEFAULT_VALUE_PROT_VCELL_UV_DELAY
    {BQ76905_REG_PROT_VCELL_UV_DELAY, BQ76905_CONFIG_VALUE_PROT_VCELL_UV_DELAY, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_UV_HYST != BQ76905_DEFAULT_VALUE_PROT_VCELL_UV_HYST
    {BQ76905_REG_PROT_VCELL_UV_HYST, BQ76905_CONFIG_VALUE_PROT_VCELL_UV_HYST, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_OV_TH != BQ76905_DEFAULT_VALUE_PROT_VCELL_OV_TH
    {BQ76905_REG_PROT_VCELL_OV_TH, BQ76905_CONFIG_VALUE_PROT_VCELL_OV_TH, 2},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_OV_DELAY != BQ76905_DEFAULT_VALUE_PROT_VCELL_OV_DELAY
    {BQ76905_REG_PROT_VCELL_OV_DELAY, BQ76905_CONFIG_VALUE_PROT_VCELL_OV_DELAY, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_VCELL_OV_HYST != BQ76905_DEFAULT_VALUE_PROT_VCELL_OV_HYST
    {BQ76905_REG_PROT_VCELL_OV_HYST, BQ76905_CONFIG_VALUE_PROT_VCELL_OV_HYST, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_CHG_TH != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_CHG_TH
    {BQ76905_REG_PROT_CUR_OC_CHG_TH, BQ76905_CONFIG_VALUE_PROT_CUR_OC_CHG_TH, 1},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_CHG_DELAY != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_CHG_DELAY
    {BQ76905_REG_PROT_CUR_OC_CHG_DELAY, BQ76905_CONFIG_VALUE_PROT_CUR_OC_CHG_DELAY, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_1_TH != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_DSG_1_TH
    {BQ76905_REG_PROT_CUR_OC_DSG_1_TH, BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_1_TH, 1},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_1_DELAY != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_DSG_1_DELAY
    {BQ76905_REG_PROT_CUR_OC_DSG_1_DELAY, BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_1_DELAY, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_2_TH != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_DSG_2_TH
    {BQ76905_REG_PROT_CUR_OC_DSG_2_TH, BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_2_TH, 1},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_2_DELAY != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_DSG_2_DELAY
    {BQ76905_REG_PROT_CUR_OC_DSG_2_DELAY, BQ76905_CONFIG_VALUE_PROT_CUR_OC_DSG_2_DELAY, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_SC_DSG_TH != BQ76905_DEFAULT_VALUE_PROT_CUR_SC_DSG_TH
    {BQ76905_REG_PROT_CUR_SC_DSG_TH, BQ76905_CONFIG_VALUE_PROT_CUR_SC_DSG_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_SC_DSG_DELAY != BQ76905_DEFAULT_VALUE_PROT_CUR_SC_DSG_DELAY
    {BQ76905_REG_PROT_CUR_SC_DSG_DELAY, BQ76905_CONFIG_VALUE_PROT_CUR_SC_DSG_DELAY, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_LATCH_LIM != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_LATCH_LIM
    {BQ76905_REG_PROT_CUR_OC_LATCH_LIM, BQ76905_CONFIG_VALUE_PROT_CUR_OC_LATCH_LIM, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_CUR_OC_REC_TIME != BQ76905_DEFAULT_VALUE_PROT_CUR_OC_REC_TIME
    {BQ76905_REG_PROT_CUR_OC_REC_TIME, BQ76905_CONFIG_VALUE_PROT_CUR_OC_REC_TIME, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_TH != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_CHG_TH
    {BQ76905_REG_PROT_TEMP_OT_CHG_TH, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_DEL != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_CHG_DEL
    {BQ76905_REG_PROT_TEMP_OT_CHG_DEL, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_DEL, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_REC != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_CHG_REC
    {BQ76905_REG_PROT_TEMP_OT_CHG_REC, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_CHG_REC, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_TH != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_CHG_TH
    {BQ76905_REG_PROT_TEMP_UT_CHG_TH, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_DEL != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_CHG_DEL
    {BQ76905_REG_PROT_TEMP_UT_CHG_DEL, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_DEL, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_REC != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_CHG_REC
    {BQ76905_REG_PROT_TEMP_UT_CHG_REC, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_CHG_REC, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_TH != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_DSG_TH
    {BQ76905_REG_PROT_TEMP_OT_DSG_TH, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_DEL != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_DSG_DEL
    {BQ76905_REG_PROT_TEMP_OT_DSG_DEL, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_DEL, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_REC != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_DSG_REC
    {BQ76905_REG_PROT_TEMP_OT_DSG_REC, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_DSG_REC, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_TH != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_DSG_TH
    {BQ76905_REG_PROT_TEMP_UT_DSG_TH, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_DEL != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_DSG_DEL
    {BQ76905_REG_PROT_TEMP_UT_DSG_DEL, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_DEL, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_REC != BQ76905_DEFAULT_VALUE_PROT_TEMP_UT_DSG_REC
    {BQ76905_REG_PROT_TEMP_UT_DSG_REC, BQ76905_CONFIG_VALUE_PROT_TEMP_UT_DSG_REC, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_TH != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_INT_TH
    {BQ76905_REG_PROT_TEMP_OT_INT_TH, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_TH, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || (BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_DEL != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_INT_DEL)
    {BQ76905_REG_PROT_TEMP_OT_INT_DEL, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_DEL, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_REC != BQ76905_DEFAULT_VALUE_PROT_TEMP_OT_INT_REC
    {BQ76905_REG_PROT_TEMP_OT_INT_REC, BQ76905_CONFIG_VALUE_PROT_TEMP_OT_INT_REC, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SLEEP_CUR != BQ76905_DEFAULT_VALUE_PWR_SLEEP_CUR
    {BQ76905_REG_PWR_SLEEP_CUR, BQ76905_CONFIG_VALUE_PWR_SLEEP_CUR, 2},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SLEEP_VOLT_TIME != BQ76905_DEFAULT_VALUE_PWR_SLEEP_VOLT_TIME
    {BQ76905_REG_PWR_SLEEP_VOLT_TIME, BQ76905_CONFIG_VALUE_PWR_SLEEP_VOLT_TIME, 1},
#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SLEEP_WAKE != BQ76905_DEFAULT_VALUE_PWR_SLEEP_WAKE
    {BQ76905_REG_PWR_SLEEP_WAKE, BQ76905_CONFIG_VALUE_PWR_SLEEP_WAKE, 1},
//#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SHDN_VCELL != BQ76905_DEFAULT_VALUE_PWR_SHDN_VCELL
    {BQ76905_REG_PWR_SHDN_VCELL, BQ76905_CONFIG_VALUE_PWR_SHDN_VCELL, 2},
//#endif

//#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SHDN_VSTACK != BQ76905_DEFAULT_VALUE_PWR_SHDN_VSTACK
    {BQ76905_REG_PWR_SHDN_VSTACK, BQ76905_CONFIG_VALUE_PWR_SHDN_VSTACK, 2},
//#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SHDN_TEMP != BQ76905_DEFAULT_VALUE_PWR_SHDN_TEMP
    {BQ76905_REG_PWR_SHDN_TEMP, BQ76905_CONFIG_VALUE_PWR_SHDN_TEMP, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_PWR_SHDN_TIME != BQ76905_DEFAULT_VALUE_PWR_SHDN_TIME
    {BQ76905_REG_PWR_SHDN_TIME, BQ76905_CONFIG_VALUE_PWR_SHDN_TIME, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_SECURITY_SETTINGS != BQ76905_DEFAULT_VALUE_SECURITY_SETTINGS
    {BQ76905_REG_SECURITY_SETTINGS, BQ76905_CONFIG_VALUE_SECURITY_SETTINGS, 1},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_SECURITY_ACCESS_KEY_1 != BQ76905_DEFAULT_VALUE_SECURITY_ACCESS_KEY_1
    {BQ76905_REG_SECURITY_ACCESS_KEY_1, BQ76905_CONFIG_VALUE_SECURITY_ACCESS_KEY_1, 2},
#endif

#if BQ76905_FORCE_ALL_REGISTERS || BQ76905_CONFIG_VALUE_SECURITY_ACCESS_KEY_2 != BQ76905_DEFAULT_VALUE_SECURITY_ACCESS_KEY_2
    {BQ76905_REG_SECURITY_ACCESS_KEY_2, BQ76905_CONFIG_VALUE_SECURITY_ACCESS_KEY_2, 2}
#endif
};

void BQ76905_configure(BQ76905_handle* handle) {
	// Apply configuration from config header
	//   configure();
	uint16_t value;
	BQ76905_WriteRamRegister(handle,BQ76905_SUBCOMMAND_SET_CFGUPDATE, 0, 0);
    
    for(uint8_t line = 0; line<sizeof(config_list)/sizeof(config_list_entry); line++)
    {
    	BQ76905_WriteRamRegister(handle,config_list[line].address, config_list[line].value, config_list[line].len);
    }
    

    BQ76905_WriteRamRegister(handle,BQ76905_SUBCOMMAND_EXIT_CFGUPDATE, 0, 0);
    for(uint8_t line = 0; line<sizeof(config_list)/sizeof(config_list_entry); line++)
    {
    	value = 0;
    	BQ76905_ReadRamRegister(handle, config_list[line].address, (uint8_t*)&value, config_list[line].len);
    	printf("BQ76905.c: Write Register %X  Value: %X Read: %X\n", config_list[line].address,  config_list[line].value, value);
    }

    BQ76905_WriteRamRegister(handle,BQ76905_SUBCOMMAND_FET_ENABLE, 0, 0);

}
